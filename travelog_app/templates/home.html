{% extends 'base.html' %}
{% load static %}
{% load django_bootstrap5 %}

{% block title %}Travelog{% endblock %}

{% block active_signup %}active{% endblock %}

{% block contents %}

{% if user.is_authenticated %}
<script src="{% static 'script/post-form.js' %}"></script>


{% for message in messages %}
{% if message.message == '投稿完了' %}
<div class="alert alert-{{ message.tags }}">
  {{ message.message }}
</div>
{% endif %}
{% endfor %}
<div class="card w-100 text-body">


<!--ここから投稿コンテンツ-->
{% for diary in diary_list %}
  <div class="user-info d-flex flex-row">
    <img src="{% static 'assets/img/55.jpg' %}" class="user-img p-2 rounded-circle" alt="...">
    <h2 class="user-name text-body py-2">@{{ diary.user_id.username}}</h2>
  </div>


    <div id="carouselExample2" class="carousel slide carousel slide" data-bs-touch="true" data-bs-ride="true">

        <div class="carousel-inner">
          {% if diary.post_image1 %}
          <div class="carousel-item active">
            <figure class="figure">
            <img src='{{ MEDIA_URL }}{{diary.post_image1}}' class="d-block w-100" data-bs-interval="false" alt="...">
            <figcaption class="figure-caption post_img p-2">ここから入りました！</figcaption>
          </figure>
          </div>
          {% endif %}

          {% if diary.post_image2 %}
          <div class="carousel-item">
            <figure class="figure">
            <img src='{{ MEDIA_URL }}{{diary.post_image2}}' class="d-block w-100" data-bs-interval="false" alt="...">
            <figcaption class="figure-caption post_img p-2">ここでお参り</figcaption>
            </figure>
          </div>
          {% endif %}

          {% if diary.post_image3 %}
          <div class="carousel-item">
            <img src='{{ MEDIA_URL }}{{diary.post_image3}}' class="d-block w-100" data-bs-interval="false" alt="...">
            <figcaption class="figure-caption post_img p-2">　</figcaption>
          </div>
          {% endif %}

          {% if diary.post_image4 %}
          <div class="carousel-item">
            <img src='{{ MEDIA_URL }}{{diary.post_image4}}' class="d-block w-100" data-bs-interval="false" alt="...">
            <figcaption class="figure-caption post_img p-2">　</figcaption>
          </div>
          {% endif %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample2" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExample2" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>

        <!--画像サムネイル表示-->

        {% if not diary.post_image1 or diary.post_image2 or diary.post_image3 %}
        <div class="carousel-indicators thumbnail_postimgs mb-1 pb-2">
          {% if diary.post_image1 %}
          <button type="button" data-bs-target="#carouselExample2" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 0">
            <img src="{{ MEDIA_URL }}{{diary.post_image1}}" class="d-block w-100" alt="...">
          </button>
          {% endif %}

          {% if diary.post_image2 %}
          <button type="button" data-bs-target="#carouselExample2" data-bs-slide-to="1" aria-label="Slide 1">
            <img src="{{ MEDIA_URL }}{{diary.post_image2}}" class="d-block w-100" alt="...">
          </button>
          {% endif %}

          {% if diary.post_image3 %}
          <button type="button" data-bs-target="#carouselExample2" data-bs-slide-to="2" aria-label="Slide 2">
            <img src="{{ MEDIA_URL }}{{diary.post_image3}}" class="d-block w-100" alt="...">
          </button>
          {% endif %}

          {% if diary.post_image4 %}
          <button type="button" data-bs-target="#carouselExample2" data-bs-slide-to="3" aria-label="Slide 2">
            <img src="{{ MEDIA_URL }}{{diary.post_image4}}" class="d-block w-100" alt="...">
          </button>
          {% endif %}
        </div>
        {% endif %}
      </div>

    <div class="card-body">
      <h2 class="card-title pt-1 pb-4">{{ diary.title}}</h2>
      <p class="card-text rounded p-3 mb-4">
        {{ diary.comment}}
      </p>


        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
              この観光地の詳細情報
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div class="accordion-body">

              <ul class="list-group mb-4">
                <li class="list-group-item"> <span class="fw-bold">国</span>：<a class="link-opacity-100" href="#">{{ diary.country}}</a></li>
                <li class="list-group-item"><span class="fw-bold">都道府県</span>：<a class="link-opacity-100" href="#">{{ diary.prefectures.prefecture_name}}</a></li>
                <li class="list-group-item"><span class="fw-bold">市町村区</span>：<a class="link-opacity-100" href="#">{{ diary.city.city_name}}</a></li>
              </ul>

              <a class="link-opacity-100" href="#">この観光地の位置</a>

            </div>
          </div>
        </div>

    <!--いいね、ブックマーク、シェアボタン-->


    <div class="container button_area py-3">
      <div class="row">
        <div class="col-2 button-item">
          <a href="#">
          <img src="{% static 'assets/img/heart_before.png' %}" alt="">
          </a>
        </div>
        <div class="col-2 button-item">
          <img src="{% static 'assets/img/bookmark_before.png' %}" alt="">
        </div>
        <div class="col-2 button-item">
          <img src="{% static 'assets/img/share.png' %}" alt="">
        </div>
      </div>
      <div class="row">
        <div class="col-2 button-item">
          <span class="post_value">
          {{ diary.likes_set.all | length }}
          </span>
        </div>
      </div>
    </div>

</div>
{% endfor %}

<!--下部メニュー-->

<nav class="navbar navbar-expand navbar-light bg-light flex-row  border-top py-1 fixed-bottom">
    <div class="container-fluid">
        <ul class="navbar-nav w-100 nav-justified align-items-center">
          <li class="nav-item w-20 text-center">
            <a class="nav-link" href="#"><img src="{% static 'assets/img/home-line.png' %}" alt="" width="50%"></a>
          </li>
          <li class="nav-item w-20 text-center">
            <a class="nav-link" href="#"><img src="{% static 'assets/img/search-line.png' %}" alt="" width="50%"></a>
          </li>
          <li class="nav-item w-20 text-center">
            <a class="nav-link" href="{% url 'travelog_app:create_post' %}"><img src="{% static 'assets/img/add-box-line.png' %}" alt="" width="80%"></a>
          </li>
          <li class="nav-item w-20 text-center">
            <a class="nav-link" href="#"><img src="{% static 'assets/img/notification-line.png' %}" alt="" width="50%"></a>
          </li>
          <li class="nav-item w-20 text-center">
            <a class="nav-link" href="#"><img src="{% static 'assets/img/user-line.png' %}" alt="" width="50%"></a>
          </li>
        </ul>
    </div>
  </nav>


{% else %}

<div class="container-fluid py-5 w-75">
    <div class="row">
        <div class="col-12 p-3">
            <img class="img-fluid" src={% static 'assets/img/top.png' %} alt="...">
        </div>
    </div>
    <div class="container-fluid py-5 w-75">
        <div class="row">
            <button type="button" class="btn btn-block btn-primary btn-lg my-4" onclick="location.href='accounts/signup/'">サインアップ</button>
            <button type="button" class="btn btn-block btn-primary btn-lg my-4" onclick="location.href='accounts/login/'">ログイン</button>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="py-5 bg-black">
    <div class="container px-5"><p class="m-0 text-center text-white small">Copyright &copy; Travelog 2024</p>
    </div>
</footer>
{% endif %}


{% endblock %}
